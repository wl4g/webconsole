<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>XCloud WebConsole</title>
	<meta name="renderer" content="webkit">
	<meta name="force-rendering" content="webkit">
	<link rel="stylesheet" href="css/xterm.css" />
	<script src="js/xterm.js"></script>
	<script src="js/jquery-3.5.1.min.js"></script>
</head>
<body>
	Welcome to XCloud WebConsole !
	<div id="terminal"></div>

	<script>
		const socket = new WebSocket('ws://10.0.0.122:8888/ws/ee');
		socket.onopen = function () {

			let window_width = $(window).width();
			let window_height = $(window).height();

			let cols = Math.floor(window_width/10);
			let rows = Math.floor(window_height/19);
			debugger

			let term = new Terminal(
					{
						cols: cols,
						rows: rows,
						useStyle:false,
						convertEol: true,
						cursorBlink:true,
						cursorStyle:null,
					});

			term.open(document.getElementById('terminal'));

			term.onData(send => socket.send(send));
			socket.onmessage = function (msg) {
				console.log(msg);
				console.log(msg.data);
				term.write(msg.data);
			};
			socket.onerror = function (e) {
				console.log(e);
			};

			socket.onclose = function (e) {
				console.log(e);
				term.destroy();
			};
		};


	</script>
</body>
</html>
